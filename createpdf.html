<form action="#" class="layui-form" id="fibrwcreate-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;FIB-RW:</span>
            <div class="layui-inline">
                <select name="type" id="typeselection">
                    <option value="1">C哥阅读下拉蓝色题目</option>
                    <option value="2">C哥阅读下拉黄色题目</option>
                    <option value="3">C哥阅读下拉白色题目</option>
                    <option value="4">C哥阅读下拉全部题目</option>
                    <option value="8">⭐️阅读下拉月预测除C哥之外题目</option>
                    <option value="5">⭐阅读下拉周预测</option>
                    <option value="6">⭐阅读下拉月预测</option>
                    <option value="7">阅读下拉收藏夹</option>
                </select>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label" style="color: red">可选选项:</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="highlight" title="高亮答案" checked>
                    <input type="checkbox" name="needchinese" title="中文速记" checked>
                    <input type="checkbox" name="analysis" title="答案解析" checked>
                </div>
            </div>
            <button class="layui-btn" lay-header-event="createfibrwpdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br>
<br>

<form action="#" class="layui-form" id="fibrcreate-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red"> &nbsp;&nbsp;&nbsp;&nbsp;FIB-R:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">C哥阅读拖拽蓝色题目</option>
                    <option value="2">C哥阅读拖拽黄色题目</option>
                    <option value="3">C哥阅读拖拽白色题目</option>
                    <option value="4">C哥阅读拖拽全部题目</option>
                    <option value="8">⭐️阅读拖拽月预测除C哥预测其他题</option>
                    <option value="5">⭐️阅读阅读拖拽周预测</option>
                    <option value="6">⭐️阅读阅读拖拽月预测</option>
                    <option value="7">阅读拖拽收藏夹</option>

                </select>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label" style="color: red">可选选项:</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="highlight" title="高亮答案" checked>
                    <input type="checkbox" name="analysis" title="答案解析" checked>
                </div>
            </div>
            <button class="layui-btn" lay-header-event="createfibrpdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br>
<br>


<form action="#" class="layui-form" id="fireflysstcreate-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;SST:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">萤火虫SST高频</option>
                    <option value="2">萤火虫SST已整理题库</option>
                    <option value="3">SST收藏夹</option>
                </select>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label" style="color: red">可选选项:</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="simpleanswer" title="英文简单答案" checked>
                    <input type="checkbox" name="keyword" title="纯关键词" checked>
                    <input type="checkbox" name="chinese" title="中文速记" checked>
                </div>
            </div>
            <button class="layui-btn" lay-header-event="fireflysstcreatepdf">
                点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br/>
<br/>
<form action="#" class="layui-form" id="pters-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;RS:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">萤火虫RS高频</option>
                    <option value="2">⭐️RS周预测</option>
                    <option value="3">⭐️RS月预测</option>
                </select>
            </div>
            <button class="layui-btn" lay-header-event="createrspdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br>
<br>
<form action="#" class="layui-form" id="ptefibl-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;FIB-L:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">萤火虫FIBL高频</option>
                    <option value="2">⭐️FIB周预测</option>
                    <option value="3">⭐️FIB月预测</option>
                </select>
            </div>
            <button class="layui-btn" lay-header-event="createfiblpdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br>
<form action="#" class="layui-form" id="pteasq-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red"> &nbsp;&nbsp;&nbsp;&nbsp;ASQ:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">萤火虫ASQ高频</option>
                </select>
            </div>
            <button class="layui-btn" lay-header-event="createasqpdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>

<script type="text/javascript">
    layui.use(['table', 'layer', 'form', 'util'], function () {
        var table = layui.table;
        var layer = layui.layer;
        var form = layui.form;
        var util = layui.util;
        fibrwInit();
        fibrInit();
        fireFlySSTInit();
        fireFlyRSInit();
        xjrsInit();
        fireFlyASQInit();
        ptefiblInit();
        form.render();
        util.event('lay-header-event', {
            createfibrwpdf: function (obj, event) { // 左侧菜单事件
                event.preventDefault();
                var newPage = document.implementation.createHTMLDocument('New Page');
                // 在新文档中添加文本
                // var head = newPage.head;
                //     // 获取当前URL
                //     var currentUrl = window.location.href;
                //
                //     // 解析当前URL
                //     var urlParts = currentUrl.split('/');
                //
                // // 移除最后一部分，即当前文件或路径
                //     urlParts.pop();
                //
                //     // 重新组合URL
                //     var parentUrl = urlParts.join('/');
                //
                //     // 如果需要加上协议头和主机名，可以手动拼接
                //     if (parentUrl.charAt(parentUrl.length - 1) !== '/') {
                //         parentUrl += '/';
                //     }
                //     console.log(parentUrl)
                // var params = JSON.stringify($("#fibrwcreate-form").serializeJson())
                var params = $("#fibrwcreate-form").serializeJson();
                var name = "C哥阅读下拉预测";
                switch (params.type) {
                    case "1":
                        name = "C哥阅读下拉蓝色题目";
                        break;

                    case "2":
                        name = "C哥阅读下拉黄色题目";
                        break;
                    case "3":
                        name = "C哥阅读下拉白色题目";
                        break;
                    case "4":
                        name = "C哥阅读下拉全部题目";
                        break;
                    case "5":
                        name = "xing️阅读下拉周预测";
                        break;
                    case "6":
                        name = "xing️阅读下拉月预测";
                        break;
                    case "7":
                        name = "阅读下拉收藏夹";
                        break;
                    case "8":
                        name = "xing️阅读下拉月预测除C哥之外题目"
                        break;

                }
                var body = newPage.body;

                var currentTypedataList = fibRwCurrentTypedata(params);
                currentTypedataList.forEach(function (item, index) {
                    //生成内容数据,添加到网页中
                    var questionHtml = createFibRwPdfHtml(params, (index + 1), item);
                    $(body).append(questionHtml);
                })
                fillPdf(newPage, name);
                return false;
            },
            createfibrpdf: function (obj, event) {
                event.preventDefault();
                var newPage = document.implementation.createHTMLDocument('New Page');
                var params = $("#fibrcreate-form").serializeJson();
                var name = "C哥阅读拖拽预测";
                switch (params.type) {
                    case "1":
                        name = "C哥阅读拖拽蓝色题目";
                        break;

                    case "2":
                        name = "C哥阅读拖拽黄色题目";
                        break;
                    case "3":
                        name = "C哥阅读拖拽白色题目";
                        break;
                    case "4":
                        name = "C哥阅读拖拽全部题目";
                        break;
                    case "5":
                        name = "xing️阅读拖拽周预测";
                        break;
                    case "6":
                        name = "xing️阅读拖拽月预测";
                        break;
                    case "7":
                        name = "阅读拖拽收藏夹";
                        break;
                    case "8":
                        name = "xing️阅读拖拽月预测除C哥之外题目"
                        break;
                }
                var body = newPage.body;

                var currentTypedataList = fibRCurrentTypedata(params);
                currentTypedataList.forEach(function (item, index) {
                    //生成内容数据,添加到网页中
                    var questionHtml = createFibRPdfHtml(params, (index + 1), item);
                    $(body).append(questionHtml);
                })
                fillPdf(newPage, name);
                return false;
            },
            fireflysstcreatepdf: function (obj, event) {
                event.preventDefault();
                var newPage = document.implementation.createHTMLDocument('New Page');
                var params = $("#fireflysstcreate-form").serializeJson();
                var name = "萤火虫sst预测";
                switch (params.type) {
                    case "1":
                        name = "萤火虫SST高频预测";
                        break;

                    case "2":
                        name = "萤火虫SST已整理预测";
                        break;
                    case "3":
                        name = "萤火虫SST收藏夹";
                        break;
                }
                var body = newPage.body;
                var currentTypedataList = fireflySSTCurrentTypedata(params);
                currentTypedataList.forEach(function (item, index) {
                    var questionHtml = createFireFlySSTPdfHtml(params, (index + 1), item);
                    $(body).append(questionHtml);
                })
                fillPdf(newPage, name);

                return false;
            },
            createrspdf: function (obj, event) {
                event.preventDefault();
                var params = $("#pters-form").serializeJson();
                var name = "";
                var newPage = document.implementation.createHTMLDocument('New Page');
                var body = newPage.body;
                switch (params.type) {
                    case "1":
                        name = "萤火虫RS高频预测";
                        $(body).append(currentFireflyRScontent());
                        break;
                    case "2":
                        name = "xjRS周预测";
                        $(body).append(currentxjrsweekconten());
                        break;
                    case "3":
                        name = "xjRS月预测";
                        $(body).append(currentxjrsmonthconten());
                        break;
                }
                fillPdf(newPage, name);
            },
            createfiblpdf: function (obj, event) {
                event.preventDefault();
                var params = $("#ptefibl-form").serializeJson();
                var name = "";
                var newPage = document.implementation.createHTMLDocument('New Page');
                var body = newPage.body;
                switch (params.type) {
                    case "1":
                        name = "萤火虫FIBL高频";
                        var fireflyfiblList = currentFireflyfiblList();
                        fireflyfiblList.forEach(function (item, index) {
                            var questionHtml = createpteFilbPdf((index + 1), item);
                            $(body).append(questionHtml);
                        })

                        break;
                    case "2":
                        name = "xjFIBL周预测";
                        var xjfiblweekList = currentxjweekFibLList();
                        xjfiblweekList.forEach(function (item, index) {
                            var questionHtml = createpteFilbPdf((index + 1), item);
                            $(body).append(questionHtml);
                        })
                        break;
                    case "3":
                        name = "xjFIBL月预测";
                        var xjfiblmonthList = currentxjmonthFibLList();
                        xjfiblmonthList.forEach(function (item, index) {
                            var questionHtml = createpteFilbPdf((index + 1), item);
                            $(body).append(questionHtml);
                        })
                        break;
                }
                fillPdf(newPage, name);
            },
            createasqpdf: function (obj, event) {
                event.preventDefault();
                var params = $("#pteasq-form").serializeJson();
                var name = "";
                var newPage = document.implementation.createHTMLDocument('New Page');
                var body = newPage.body;
                switch (params.type) {
                    case "1":
                        name = "萤火虫ASQ高频预测";
                        $(body).append(currentFireflyASQcontent());
                        break;
                }
                fillPdf(newPage, name);
            }
        })
    });
    $.fn.serializeJson = function () {
        var serializeObj = {};
        var array = this.serializeArray();
        $.each(array, function () {
            if (serializeObj[this.name] !== undefined) {
                if (!serializeObj[this.name].push) {
                    serializeObj[this.name] = [serializeObj[this.name]];
                }
                serializeObj[this.name].push(this.value || '');
            } else {
                serializeObj[this.name] = this.value || '';
            }
        });
        return serializeObj;
    };


    function fillPdf(newPage, name) {
        //var newPage = document.implementation.createHTMLDocument('New Page');
        var head = newPage.head;
        head.innerHTML = "<meta charset=\"utf-8\">\n" +
            "    <title>" + name + "</title>\n" +
            "    <meta name=\"renderer\" content=\"webkit\">\n" +
            "    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n" +
            "    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n" +
            "    <link href='https://cdn.staticfile.net/layui/2.9.4/css/layui.css' rel=\"stylesheet\">\n" +
            "    <style>\n" +
            "        @font-face {\n" +
            "            font-family: AaManYuShouXieTi;\n" +
            "            src: url('https://gitee.com/api/v5/repos/jackiechan/ptepractise/raw/font%2FAaManYuShouXieTi3.ttf?access_token=c87299575627265144b7db286d3bf673');\n" +
            "        }\n" +
            "    </style>";
        // var body = newPage.body;
        // $(body).append(content);
        // 打开新页面并写入内容
        var newWindow = window.open('', '_blank');
        newWindow.document.write(newPage.documentElement.outerHTML);
        newWindow.document.close();

    }

</script>
