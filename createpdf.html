<form action="#" class="layui-form" id="ddasda">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;部分题型的的选项比较多,展示不全需要滑动才可以</span>
        </div>
    </div>
</form>
<br/>
<br/>
<form action="#" class="layui-form" id="fireflywfdcreate-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;WFD:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="-1">萤火虫WFD注音正序版</option>
                    <option value="-2">萤火虫WFD注音倒序版</option>
                    <option value="-3">萤火虫WFD正序无注音版</option>
                    <option value="1">萤火虫WFD首字母</option>
                    <option value="2">萤火虫WFD分类版</option>
                    <option value="3">大西瓜萤火虫WFD相似句</option>
                    <option value="4">萤火虫WFD纯文本</option>
                </select>
            </div>
            <button class="layui-btn" lay-header-event="fireflywfdcreatepdf">
                点击后在新页面直接下载pdf
            </button>
        </div>
    </div>
</form>
<br/>
<br/>
<form action="#" class="layui-form" id="fibrwcreate-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;FIB-RW:</span>
            <div class="layui-inline">
                <select name="type" id="typeselection">
                    <option value="1">C哥阅读下拉蓝色题目</option>
                    <option value="2">C哥阅读下拉黄色题目</option>
                    <option value="3">C哥阅读下拉白色题目</option>
                    <option value="4">C哥阅读下拉全部题目</option>
                    <option value="8">⭐️阅读下拉月预测除C哥之外题目</option>
                    <option value="5">⭐阅读下拉周预测</option>
                    <option value="6">⭐阅读下拉月预测</option>
                    <option value="7">阅读下拉收藏夹</option>
                    <option value="10">⭐全</option>
                    <option value="11">⭐全EN</option>
                    <option value="100">⭐阅读FIBRW全题库答案比例</option>
                    <option value="101">⭐阅读FIBRW答案比例数EN九百题库</option>
                </select>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label" style="color: red">可选选项:</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="highlight" title="高亮答案" checked>
                    <input type="checkbox" name="needchinese" title="中文速记" checked>
                    <input type="checkbox" name="analysis" title="答案解析" checked>
                    <input type="checkbox" name="trans" title="全文翻译">
                </div>
            </div>
            <button class="layui-btn" lay-header-event="createfibrwpdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br>
<br>

<form action="#" class="layui-form" id="fibrcreate-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red"> &nbsp;&nbsp;&nbsp;&nbsp;FIB-R:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">C哥阅读拖拽蓝色题目</option>
                    <option value="2">C哥阅读拖拽黄色题目</option>
                    <option value="3">C哥阅读拖拽白色题目</option>
                    <option value="4">C哥阅读拖拽全部题目</option>
                    <option value="8">⭐️阅读拖拽月预测除C哥预测其他题</option>
                    <option value="5">⭐️阅读阅读拖拽周预测</option>
                    <option value="6">⭐️阅读阅读拖拽月预测</option>
                    <option value="7">阅读拖拽收藏夹</option>
                    <option value="10">⭐全</option>
                    <option value="11">⭐全EN</option>

                </select>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label" style="color: red">可选选项:</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="highlight" title="高亮答案" checked>
                    <input type="checkbox" name="analysis" title="答案解析" checked>
                    <input type="checkbox" name="trans" title="全文翻译">
                </div>
            </div>
            <button class="layui-btn" lay-header-event="createfibrpdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br>
<br>
<form action="#" class="layui-form" id="xjrocreate-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red"> &nbsp;&nbsp;&nbsp;&nbsp;RO:</span>
            <div class="layui-inline">
                <select name="type" id="xjrotypeselection">
                    <option value="1">C哥阅读RO蓝色题目</option>
                    <option value="2">C哥阅读RO黄色题目</option>
                    <option value="3">C哥阅读RO白色题目</option>
                    <option value="4">C哥阅读RO全部题目</option>
                    <option value="8">⭐️阅读RO月预测除C哥预测其他题</option>
                    <option value="7">阅读RO收藏夹</option>
                    <option value="5">⭐️阅读RO周预测</option>
                    <option value="6">⭐️阅读RO月预测</option>
                    <option value="9">错题集</option>

                </select>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label" style="color: red">可选选项:</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="shunkouliu" title="顺口溜" checked>
                </div>
            </div>
            <button class="layui-btn" lay-header-event="createxjropdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br>


<form action="#" class="layui-form" id="fireflysstcreate-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;SST:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">萤火虫SST高频</option>
                    <option value="2">萤火虫SST已整理题库</option>
                    <option value="3">SST收藏夹</option>
                </select>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label" style="color: red">可选选项:</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="simpleanswer" title="英文简单答案" checked>
                    <input type="checkbox" name="keyword" title="纯关键词" checked>
                    <input type="checkbox" name="chinese" title="中文速记" checked>
                    <input type="checkbox" name="logicpic" title="逻辑梳理图(部分题)" checked>
                </div>
            </div>
            <button class="layui-btn" lay-header-event="fireflysstcreatepdf">
                点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br/>
<br/>
<form action="#" class="layui-form" id="fireflywecreate-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;WE:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">萤火虫WE高频</option>
                    <option value="2">萤火虫WE已整理题库</option>
                    <option value="3">WE收藏夹</option>
                    <option value="4">WE模板1</option>
                    <option value="5">WE模板2</option>
                    <option value="6">WE模板3</option>
                    <option value="7">WE万能句</option>
                </select>
            </div>
            <div class="layui-inline">
                <label class="layui-form-label" style="color: red">可选选项:</label>
                <div class="layui-input-block">
                    <input type="checkbox" name="view" title="观点(仅供参考" checked>
                    <input type="checkbox" name="example" title="范文(仅供参考)">
                </div>
            </div>
            <button class="layui-btn" lay-header-event="fireflywecreatepdf">
                点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br/>
<br/>

<form action="#" class="layui-form" id="pters-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;RS:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">萤火虫RS高频</option>
                    <option value="2">⭐️RS周预测</option>
                    <option value="3">⭐️RS月预测</option>
                    <option value="4">⭐️RS全题目</option>
                    <option value="5">⭐️RS全题目题号排序</option>
                </select>
            </div>
            <button class="layui-btn" lay-header-event="createrspdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br>
<br>
<form action="#" class="layui-form" id="ptefibl-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red">&nbsp;&nbsp;&nbsp;&nbsp;FIB-L:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">萤火虫FIBL高频</option>
                    <option value="2">⭐️FIB周预测</option>
                    <option value="3">⭐️FIB月预测</option>
                    <option value="100">⭐️FIB听力单词频率</option>
                </select>
            </div>
            <button class="layui-btn" lay-header-event="createfiblpdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>
<br>
<form action="#" class="layui-form" id="pteasq-form">
    <div class="layui-form-item">
        <div class="layui-inline">
            <span style="font-size: 16px; color: red"> &nbsp;&nbsp;&nbsp;&nbsp;ASQ:</span>
            <div class="layui-inline">
                <select name="type">
                    <option value="1">萤火虫ASQ高频</option>
                    <option value="5">⭐️ASQ周预测</option>
                    <option value="6">⭐️ASQ月预测</option>
                    <option value="10">⭐️ASQ全题库</option>
                </select>
            </div>
            <button class="layui-btn" lay-header-event="createasqpdf">点击生成网页后通过浏览器的打印功能保存为pdf
            </button>
        </div>
    </div>
</form>

<script type="text/javascript">
    layui.use(['table', 'layer', 'form', 'util'], function () {
        var table = layui.table;
        var layer = layui.layer;
        var form = layui.form;
        var util = layui.util;
        fibrwInit();
        fibrInit();
        fireFlySSTInit();
        fireFlyRSInit();
        xjrsInit();
        fireFlyASQInit();
        ptefiblInit();
        fireFlyWeInit();
        xjroInit();
        fireFlyWFDInit();
        xjAsqInit();
        form.render();
        util.event('lay-header-event', {
            createfibrwpdf: function (obj, event) { // 左侧菜单事件
                event.preventDefault();
                var newPage = document.implementation.createHTMLDocument('New Page');
                // 在新文档中添加文本
                // var head = newPage.head;
                //     // 获取当前URL
                //     var currentUrl = window.location.href;
                //
                //     // 解析当前URL
                //     var urlParts = currentUrl.split('/');
                //
                // // 移除最后一部分，即当前文件或路径
                //     urlParts.pop();
                //
                //     // 重新组合URL
                //     var parentUrl = urlParts.join('/');
                //
                //     // 如果需要加上协议头和主机名，可以手动拼接
                //     if (parentUrl.charAt(parentUrl.length - 1) !== '/') {
                //         parentUrl += '/';
                //     }
                //     console.log(parentUrl)
                // var params = JSON.stringify($("#fibrwcreate-form").serializeJson())
                var params = $("#fibrwcreate-form").serializeJson();
                var name = "C哥阅读下拉预测";
                switch (params.type) {
                    case "1":
                        name = "C哥阅读下拉蓝色题目";
                        break;

                    case "2":
                        name = "C哥阅读下拉黄色题目";
                        break;
                    case "3":
                        name = "C哥阅读下拉白色题目";
                        break;
                    case "4":
                        name = "C哥阅读下拉全部题目";
                        break;
                    case "5":
                        name = "xing️阅读下拉周预测";
                        break;
                    case "6":
                        name = "xing️阅读下拉月预测";
                        break;
                    case "7":
                        name = "阅读下拉收藏夹";
                        break;
                    case "8":
                        name = "xing️阅读下拉月预测除C哥之外题目"
                        break;
                    case "10":
                        name = "⭐️下拉全"
                        break;
                    case "11":
                        name = "⭐️下拉全en"
                        break;
                    case "100":
                        //fibrw答案比例
                        window.open("https://kdocs.cn/l/cfhVRWRNzRUk", '_blank');
                        return ;
                    case "101":
                        //fibrw答案比例en
                        window.open("https://kdocs.cn/l/ciAzNLjcDMoW", '_blank');
                        return;

                }
                var body = newPage.body;

                var currentTypedataList = fibRwCurrentTypedata(params);
                currentTypedataList.forEach(function (item, index) {
                    //生成内容数据,添加到网页中
                    var questionHtml = createFibRwPdfHtml(params, (index + 1), item);
                    $(body).append(questionHtml);
                })
                fillPdf(newPage, name);
                return false;
            }, createxjropdf: function (obj, event) {
                event.preventDefault();
                var newPage = document.implementation.createHTMLDocument('New Page');
                var params = $("#xjrocreate-form").serializeJson();
                var name = "C哥阅读拖拽预测";
                switch (params.type) {
                    case "1":
                        name = "C哥阅读RO蓝色题目";
                        break;

                    case "2":
                        name = "C哥阅读RO黄色题目";
                        break;
                    case "3":
                        name = "C哥阅读RO白色题目";
                        break;
                    case "4":
                        name = "C哥阅读RO全部题目";
                        break;
                    case "7":
                        name = "阅读RO收藏夹";
                        break;
                    case "8":
                        name = "⭐️阅读RO月预测除C哥预测其他题"
                        break;
                    case "8":
                        name = "RO错题集"
                        break;
                }
                var body = newPage.body;

                var currentTypedataList = xjroCurrentTypedata(params);
                currentTypedataList.forEach(function (item, index) {
                    //生成内容数据,添加到网页中
                    var questionHtml = createxjroPdfHtml(params, (index + 1), item);
                    $(body).append(questionHtml);
                })
                fillPdf(newPage, name);
                return false;


            },
            createfibrpdf: function (obj, event) {
                event.preventDefault();
                var newPage = document.implementation.createHTMLDocument('New Page');
                var params = $("#fibrcreate-form").serializeJson();
                var name = "C哥阅读拖拽预测";
                switch (params.type) {
                    case "1":
                        name = "C哥阅读拖拽蓝色题目";
                        break;

                    case "2":
                        name = "C哥阅读拖拽黄色题目";
                        break;
                    case "3":
                        name = "C哥阅读拖拽白色题目";
                        break;
                    case "4":
                        name = "C哥阅读拖拽全部题目";
                        break;
                    case "5":
                        name = "xing️阅读拖拽周预测";
                        break;
                    case "6":
                        name = "xing️阅读拖拽月预测";
                        break;
                    case "7":
                        name = "阅读拖拽收藏夹";
                        break;
                    case "8":
                        name = "xing️阅读拖拽月预测除C哥之外题目"
                        break;
                    case "10":
                        name = "⭐️拖拽全"
                        break;
                    case "11":
                        name = "⭐️拖拽全EN"
                        break;
                }
                var body = newPage.body;

                var currentTypedataList = fibRCurrentTypedata(params);
                currentTypedataList.forEach(function (item, index) {
                    //生成内容数据,添加到网页中
                    var questionHtml = createFibRPdfHtml(params, (index + 1), item);
                    $(body).append(questionHtml);
                })
                fillPdf(newPage, name);
                return false;
            },
            fireflysstcreatepdf: function (obj, event) {
                event.preventDefault();
                var newPage = document.implementation.createHTMLDocument('New Page');
                var params = $("#fireflysstcreate-form").serializeJson();
                var name = "萤火虫sst预测";
                switch (params.type) {
                    case "1":
                        name = "萤火虫SST高频预测";
                        break;

                    case "2":
                        name = "萤火虫SST已整理预测";
                        break;
                    case "3":
                        name = "萤火虫SST收藏夹";
                        break;
                }
                var body = newPage.body;
                var currentTypedataList = fireflySSTCurrentTypedata(params);
                currentTypedataList.forEach(function (item, index) {
                    var questionHtml = createFireFlySSTPdfHtml(params, (index + 1), item);
                    $(body).append(questionHtml);
                })
                fillPdf(newPage, name);

                return false;
            },fireflywfdcreatepdf: function (obj, event) {
                event.preventDefault();
                var params = $("#fireflywfdcreate-form").serializeJson();
                var url = "";
                var newPage = document.implementation.createHTMLDocument('New Page');
                var name = "萤火虫wfd预测";

                switch (params.type) {
                    case "-1":
                      //  name = "萤火虫WFD注音正序版";
                    url=getRawPre()+"/pdf/萤火虫WFD注音正序.pdf"
                        break;
                    case "-2":
                        //name = "萤火虫WFD注音倒序版";
                        url=getRawPre()+"/pdf/萤火虫WFD注音倒序.pdf"
                        break;
                    case "-3":
                        //name = "萤火虫WFD注音倒序版";
                        url=getRawPre()+"/pdf/萤火虫WFD正序版.pdf"
                        break;
                    case "1":
                      //  name = "萤火虫WFD首字母版";
                        url=getRawPre()+"/pdf/萤火虫WFD首字母.pdf"
                        break;

                    case "2":
                       name = "萤火虫WFD分类版";
                       // url=getRawPre()+"/pdf/萤火虫WFD分类版.pdf"
                        var content = loadwfdpdfmd("萤火虫WFD分类版.md","萤火虫WFD分类版");

                        return ;
                    case "3":
                       // name = "萤火虫WFD分类版";
                        url=getRawPre()+"/pdf/wfd萤火虫大西瓜相似句.pdf"
                        break;
                    case "4":
                       // name = "纯文本";
                        url=getRawPre()+"/data/wfd/yhcwfdplaintxt.txt"
                        var body = newPage.body;
                        body.innerHTML=getWFDPlainTxt();
                        fillPdf(newPage, name);
                        return ;
                }
                window.open(url, '_blank');
                return false;
            },
            fireflywecreatepdf: function (obj, event) {
                event.preventDefault();
                var newPage = document.implementation.createHTMLDocument('New Page');
                var params = $("#fireflywecreate-form").serializeJson();
                var name = "萤火虫we预测";
                switch (params.type) {
                    case "1":
                        name = "萤火虫WE高频预测";
                        break;
                    case "2":
                        name = "萤火虫WE已整理预测";
                        break;
                    case "3":
                        name = "萤火虫WE收藏夹";
                        break;
                    case "4":
                        window.open(getRawPre()+"/pdf/we模板1.pdf", '_blank');
                        return ;
                    case "5":
                        window.open(getRawPre()+"/pdf/we模板2.pdf", '_blank');
                        return;
                    case "6":
                        window.open(getRawPre()+"/pdf/we模板3.pdf", '_blank');
                        return;
                    case "7":
                        window.open(getRawPre()+"/pdf/WE万能句.pdf", '_blank');
                        return;
                }
                var body = newPage.body;
                var currentTypedataList = fireflyWeCurrentTypedata(params);
                currentTypedataList.forEach(function (item, index) {
                    var questionHtml = createFireFlyWePdfHtml(params, (index + 1), item);
                    $(body).append(questionHtml);
                })
                fillPdf(newPage, name);
                return false;
            },
            createrspdf: function (obj, event) {
                event.preventDefault();
                var params = $("#pters-form").serializeJson();
                var name = "";
                var newPage = document.implementation.createHTMLDocument('New Page');
                var body = newPage.body;
                switch (params.type) {
                    case "1":
                        name = "萤火虫RS高频预测";
                        $(body).append(currentFireflyRScontent());
                        break;
                    case "2":
                        name = "xjRS周预测";
                        $(body).append(currentxjrsweekconten());
                        break;
                    case "3":
                        name = "xjRS月预测";
                        $(body).append(currentxjrsmonthconten());
                        break;
                    case "4":
                        name = "xjRS全题目";
                        $(body).append(currentxjrsallcontent());
                        break;
                    case "5":
                        name = "xjRS全题目题号排序";
                        $(body).append(currentxjrsallcontentdesc());
                        break;
                }
                fillPdf(newPage, name);
            },
            createfiblpdf: function (obj, event) {
                event.preventDefault();
                var params = $("#ptefibl-form").serializeJson();
                var name = "";
                var newPage = document.implementation.createHTMLDocument('New Page');
                var body = newPage.body;
                switch (params.type) {
                    case "1":
                        name = "萤火虫FIBL高频";
                        var fireflyfiblList = currentFireflyfiblList();
                        fireflyfiblList.forEach(function (item, index) {
                            var questionHtml = createpteFilbPdf((index + 1), item);
                            $(body).append(questionHtml);
                        })

                        break;
                    case "2":
                        name = "xjFIBL周预测";
                        var xjfiblweekList = currentxjweekFibLList();
                        xjfiblweekList.forEach(function (item, index) {
                            var questionHtml = createpteFilbPdf((index + 1), item);
                            $(body).append(questionHtml);
                        })
                        break;
                    case "3":
                        name = "xjFIBL月预测";
                        var xjfiblmonthList = currentxjmonthFibLList();
                        xjfiblmonthList.forEach(function (item, index) {
                            var questionHtml = createpteFilbPdf((index + 1), item);
                            $(body).append(questionHtml);
                        })
                        break;
                    case "100":
                        //FIBL听力单词频率
                        window.open("https://kdocs.cn/l/cfNwyDVTkg9r", '_blank');
                        return;
                }
                fillPdf(newPage, name);
            },
            createasqpdf: function (obj, event) {
                event.preventDefault();
                var params = $("#pteasq-form").serializeJson();
                var name = "";
                var newPage = document.implementation.createHTMLDocument('New Page');
                var body = newPage.body;
                switch (params.type) {
                    case "1":
                        name = "萤火虫ASQ高频预测";
                        $(body).append(currentFireflyASQcontent());
                        break;
                    case "5":
                        name = "⭐️ASQ周预测";
                        fillxjasqdata(params, body);
                        break;
                    case "6":
                        name = "⭐️ASQ月预测";
                        fillxjasqdata(params, body);
                        break;
                    case "10":
                        name = "⭐️ASQ全题库";
                        fillxjasqdata(params, body);
                        break;
                }
                fillPdf(newPage, name);
            }
        })
    });
    $.fn.serializeJson = function () {
        var serializeObj = {};
        var array = this.serializeArray();
        $.each(array, function () {
            if (serializeObj[this.name] !== undefined) {
                if (!serializeObj[this.name].push) {
                    serializeObj[this.name] = [serializeObj[this.name]];
                }
                serializeObj[this.name].push(this.value || '');
            } else {
                serializeObj[this.name] = this.value || '';
            }
        });
        return serializeObj;
    };
function fillxjasqdata(params,body){
    XjAsqCurrentTypedata(params);
    var currentXjAsqList1 = currentXjAsqList();
    currentXjAsqList1.forEach(function (item, index) {
        var questionHtml = createXjAsqPdfHtml((index + 1), item);
        $(body).append(questionHtml);
    })
}

    function fillPdf(newPage, name) {
        //var newPage = document.implementation.createHTMLDocument('New Page');
        var head = newPage.head;
        head.innerHTML = "<meta charset=\"utf-8\">\n" +
            "    <title>" + name + "</title>\n" +
            "    <meta name=\"renderer\" content=\"webkit\">\n" +
            "    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n" +
            "    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n" +
            "    <link href='https://cdn.staticfile.net/layui/2.9.4/css/layui.css' rel=\"stylesheet\">\n" +
            "    <style>\n" +
            "        @font-face {\n" +
            "            font-family: AaManYuShouXieTi;\n" +
            "            src: url('https://gitee.com/api/v5/repos/jackiechan/ptepractise/raw/font%2FAaManYuShouXieTi3.ttf?access_token=c87299575627265144b7db286d3bf673');\n" +
            "        }\n" +
            "    </style>";
        // var body = newPage.body;
        // $(body).append(content);
        // 打开新页面并写入内容
        var newWindow = window.open('', '_blank');
        newWindow.document.write(newPage.documentElement.outerHTML);
        newWindow.document.close();

    }

</script>
